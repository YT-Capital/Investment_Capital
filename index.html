<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YAT Capital - Website Prototype</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --accent-from: #4f46e5;
      --accent-to: #06b6d4;
    }
    body { font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; }
    .hero-bg { background: radial-gradient(ellipse at top left, rgba(79, 70, 229, 0.06), transparent 20%), radial-gradient(ellipse at bottom right, rgba(6, 182, 212, 0.04), transparent 20%); }
    .glass { backdrop-filter: blur(6px); background-color: rgba(255, 255, 255, 0.6); }
    @media (prefers-color-scheme: dark) {
      .glass { background-color: rgba(17, 24, 39, 0.5); }
    }
    
    /* Animations */
    .fade-in { animation: fadeIn 0.5s ease-out forwards; opacity: 0; }
    .slide-up { animation: slideUp 0.6s ease-out forwards; opacity: 0; transform: translateY(20px); }
    .slide-up-1 { animation-delay: 0.1s; }
    .slide-up-2 { animation-delay: 0.2s; }
    .slide-up-3 { animation-delay: 0.3s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    /* Hover effects */
    .hover-grow { transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
    .hover-grow:hover { transform: translateY(-4px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
    .tab-btn:hover { border-bottom-color: var(--accent-from); }
    
    /* Custom styles */
    .tab-section.hidden { display: none; }
    .text-gradient { background-image: linear-gradient(to right, var(--accent-from), var(--accent-to)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .ring-gradient:focus { outline: none; box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.5); }
    
    /* Modal */
    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); display: flex; justify-content: center; align-items: center; z-index: 1000; }
    .modal-content { background-color: #fff; padding: 2rem; border-radius: 1rem; max-width: 500px; width: 100%; }
    .modal-content.dark { background-color: #1f2937; color: #f3f4f6; }
  </style>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100">

  <header class="hero-bg border-b border-gray-200 dark:border-gray-800 slide-up slide-up-1">
    <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
      <a href="#" class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-indigo-600 to-teal-400 flex items-center justify-center text-white font-bold text-lg">Y</div>
        <div>
          <div class="text-lg font-bold">YAT Capital</div>
          <div class="text-xs text-gray-500 dark:text-gray-400">Website Prototype</div>
        </div>
      </a>
      <nav class="hidden md:flex items-center gap-2 text-sm" role="tablist" aria-label="Main Tabs">
        <button data-tab="overview" class="tab-btn px-3 py-2 rounded-md border-b-2 border-transparent transition-colors duration-200 ease-in-out" role="tab"><i class="fa-solid fa-chart-line mr-2"></i>Tổng quan</button>
        <button data-tab="screener" class="tab-btn px-3 py-2 rounded-md border-b-2 border-transparent transition-colors duration-200 ease-in-out" role="tab"><i class="fa-solid fa-filter mr-2"></i>Bộ lọc cổ phiếu</button>
        <button data-tab="investment-system" class="tab-btn px-3 py-2 rounded-md border-b-2 border-transparent transition-colors duration-200 ease-in-out" role="tab"><i class="fa-solid fa-brain mr-2"></i>Hệ thống đầu tư</button>
        <button data-tab="watchlist" class="tab-btn px-3 py-2 rounded-md border-b-2 border-transparent transition-colors duration-200 ease-in-out" role="tab"><i class="fa-solid fa-eye mr-2"></i>Theo dõi</button>
        <button data-tab="contact" class="tab-btn px-3 py-2 rounded-md border-b-2 border-transparent transition-colors duration-200 ease-in-out" role="tab"><i class="fa-solid fa-envelope mr-2"></i>Liên hệ</button>
      </nav>
    </div>
    <div class="md:hidden border-t border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-gray-900/60">
      <div class="max-w-7xl mx-auto px-4 py-2 flex gap-2 overflow-x-auto">
        <button data-tab="overview" class="tab-btn px-3 py-2 rounded-md text-sm"><i class="fa-solid fa-chart-line"></i></button>
        <button data-tab="screener" class="tab-btn px-3 py-2 rounded-md text-sm"><i class="fa-solid fa-filter"></i></button>
        <button data-tab="investment-system" class="tab-btn px-3 py-2 rounded-md text-sm"><i class="fa-solid fa-brain"></i></button>
        <button data-tab="watchlist" class="tab-btn px-3 py-2 rounded-md text-sm"><i class="fa-solid fa-eye"></i></button>
        <button data-tab="contact" class="tab-btn px-3 py-2 rounded-md text-sm"><i class="fa-solid fa-envelope"></i></button>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-6 py-8">
    <section id="overviewSection" class="tab-section fade-in slide-up-1">
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
        <div class="lg:col-span-2">
          <div class="glass rounded-2xl p-6 shadow-md slide-up slide-up-2">
            <div class="flex items-start justify-between">
              <div>
                <h1 class="text-3xl font-bold text-gradient">Tổng quan thị trường</h1>
                <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Snapshot các chỉ số chính và biểu đồ xu hướng.</p>
              </div>
              <div class="text-sm text-gray-500">Updated: <span id="updatedTime">--</span></div>
            </div>
            <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
              <div class="p-4 rounded-xl bg-white dark:bg-gray-800 shadow-sm hover-grow">
                <div class="text-xs text-gray-500">VN-Index</div>
                <div class="text-2xl font-bold" id="vnIndexVal">1,234.56</div>
                <div class="text-sm text-green-500 font-medium" id="vnIndexChange">+1.2% (24h)</div>
              </div>
              <div class="p-4 rounded-xl bg-white dark:bg-gray-800 shadow-sm hover-grow">
                <div class="text-xs text-gray-500">S&P 500</div>
                <div class="text-2xl font-bold" id="spVal">4,567</div>
                <div class="text-sm text-red-500 font-medium" id="spChange">-0.3% (24h)</div>
              </div>
              <div class="p-4 rounded-xl bg-white dark:bg-gray-800 shadow-sm hover-grow">
                <div class="text-xs text-gray-500">USD/VND</div>
                <div class="text-2xl font-bold" id="fxVal">23,600</div>
                <div class="text-sm text-green-500 font-medium" id="fxChange">+0.1% (24h)</div>
              </div>
            </div>
            <div class="mt-6">
              <div class="flex items-center gap-3">
                <div class="text-sm">Khung thời gian:</div>
                <div class="flex gap-2">
                  <button class="time-btn px-2 py-1 rounded-md text-sm border hover:border-indigo-600 transition-colors" data-interval="1D">1D</button>
                  <button class="time-btn px-2 py-1 rounded-md text-sm border hover:border-indigo-600 transition-colors" data-interval="1W">1W</button>
                  <button class="time-btn px-2 py-1 rounded-md text-sm border hover:border-indigo-600 transition-colors" data-interval="1M">1M</button>
                  <button class="time-btn px-2 py-1 rounded-md text-sm border hover:border-indigo-600 transition-colors" data-interval="1Y">1Y</button>
                </div>
                <div class="ml-auto">
                  <label class="text-sm mr-2">Loại biểu đồ:</label>
                  <select id="chartType" class="rounded-md p-1 text-sm border dark:border-gray-700 bg-transparent ring-gradient">
                    <option value="line">Line</option>
                    <option value="bar">Bar</option>
                    <option value="doughnut">Doughnut</option>
                  </select>
                </div>
              </div>
              <div class="mt-4">
                <canvas id="marketChart" height="140"></canvas>
              </div>
            </div>
          </div>
          <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4 slide-up slide-up-3">
            <div class="p-4 bg-white dark:bg-gray-800 rounded-2xl shadow hover-grow">
              <h3 class="font-semibold text-lg">Model: Growth</h3>
              <p class="text-sm text-gray-500">5 holdings • Focus on revenue growth</p>
              <div class="mt-3 text-xl font-bold text-indigo-500">+12.4% YTD</div>
            </div>
            <div class="p-4 bg-white dark:bg-gray-800 rounded-2xl shadow hover-grow">
              <h3 class="font-semibold text-lg">Model: Value</h3>
              <p class="text-sm text-gray-500">7 holdings • Value picks</p>
              <div class="mt-3 text-xl font-bold text-green-500">+6.8% YTD</div>
            </div>
            <div class="p-4 bg-white dark:bg-gray-800 rounded-2xl shadow hover-grow">
              <h3 class="font-semibold text-lg">Model: Balanced</h3>
              <p class="text-sm text-gray-500">Mix of stocks & bonds</p>
              <div class="mt-3 text-xl font-bold text-teal-500">+8.9% YTD</div>
            </div>
          </div>
        </div>
        <aside class="space-y-6 slide-up slide-up-3">
          <div class="glass p-4 rounded-2xl shadow">
            <h4 class="font-bold text-lg"><i class="fa-solid fa-bullhorn mr-2 text-red-500"></i>Tin tức nhanh</h4>
            <ul class="mt-3 text-sm space-y-2" id="newsList">
              <li>● GDP Q2 tăng, tác động đến dòng tiền</li>
              <li>● VIC đạt target, trader chú ý</li>
              <li>● Cập nhật tỷ giá USD/VND</li>
            </ul>
          </div>
          <div class="glass p-4 rounded-2xl shadow">
            <h4 class="font-bold text-lg">Quick actions</h4>
            <div class="mt-3 grid grid-cols-1 gap-2">
              <button class="py-2 rounded-md border border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Export CSV</button>
              <button class="py-2 rounded-md border border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Generate Report</button>
            </div>
          </div>
        </aside>
      </div>
    </section>

    <section id="screenerSection" class="tab-section hidden fade-in">
      <div class="glass p-6 rounded-2xl shadow mb-6">
        <h2 class="text-2xl font-bold text-gradient"><i class="fa-solid fa-filter mr-2"></i>Bộ lọc cổ phiếu</h2>
        <p class="text-sm text-gray-500">Nhập tiêu chí để lọc (dữ liệu mô phỏng).</p>
        <div class="mt-4 grid grid-cols-1 md:grid-cols-6 gap-4 items-end">
          <div>
            <label class="block text-gray-600 dark:text-gray-300 text-sm">P/E ≤</label>
            <input id="peInput" type="number" class="mt-1 w-full rounded-md border-gray-200 dark:border-gray-700 p-2 bg-transparent ring-gradient" placeholder="e.g. 15" />
          </div>
          <div>
            <label class="block text-gray-600 dark:text-gray-300 text-sm">EPS ≥</label>
            <input id="epsInput" type="number" class="mt-1 w-full rounded-md border-gray-200 dark:border-gray-700 p-2 bg-transparent ring-gradient" placeholder="e.g. 4000" />
          </div>
          <div>
            <label class="block text-gray-600 dark:text-gray-300 text-sm">ROE ≥</label>
            <input id="roeInput" type="number" class="mt-1 w-full rounded-md border-gray-200 dark:border-gray-700 p-2 bg-transparent ring-gradient" placeholder="e.g. 15" />
          </div>
          <div>
            <label class="block text-gray-600 dark:text-gray-300 text-sm">B/E ≤</label>
            <input id="beInput" type="number" class="mt-1 w-full rounded-md border-gray-200 dark:border-gray-700 p-2 bg-transparent ring-gradient" placeholder="e.g. 15" />
          </div>
          <div>
            <label class="block text-gray-600 dark:text-gray-300 text-sm">P/E average ≤</label>
            <input id="peAvgInput" type="number" class="mt-1 w-full rounded-md border-gray-200 dark:border-gray-700 p-2 bg-transparent ring-gradient" placeholder="e.g. 15" />
          </div>
          <div>
            <label class="block text-gray-600 dark:text-gray-300 text-sm">Sector</label>
            <select id="sectorInput" class="mt-1 w-full rounded-md border-gray-200 dark:border-gray-700 p-2 bg-transparent text-sm ring-gradient">
              <option value="">All</option><option>Finance</option><option>IT</option><option>Retail</option><option>Real Estate</option>
            </select>
          </div>
          <div class="md:col-span-2 flex gap-2">
            <button id="runScreenerBtn" class="w-full py-2 rounded-md bg-gradient-to-r from-indigo-600 to-teal-400 text-white font-medium hover:opacity-90 transition-opacity">
              <span id="runBtnText">Run</span>
              <i id="runBtnSpinner" class="fas fa-spinner fa-spin ml-2 hidden"></i>
            </button>
            <button id="resetScreenerBtn" class="w-full py-2 rounded-md border border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Reset</button>
          </div>
        </div>
      </div>
      <div class="glass rounded-2xl p-4 shadow">
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm" aria-label="Screener results">
            <thead class="text-left text-gray-500">
              <tr>
                <th class="px-4 py-2" data-tooltip="Mã cổ phiếu">Mã</th>
                <th class="px-4 py-2" data-tooltip="Tên công ty">Tên</th>
                <th class="px-4 py-2 text-right" data-tooltip="Giá trên thu nhập (Price-to-Earnings)">P/E</th>
                <th class="px-4 py-2 text-right" data-tooltip="Thu nhập trên mỗi cổ phiếu (Earnings Per Share)">EPS</th>
                <th class="px-4 py-2 text-right" data-tooltip="Lợi nhuận trên vốn chủ sở hữu (Return On Equity)">ROE</th>
                <th class="px-4 py-2 text-right" data-tooltip="Tỷ lệ giá trên giá trị sổ sách (Price-to-Book)">B/E</th>
                <th class="px-4 py-2 text-right" data-tooltip="Giá trên thu nhập trung bình">P/E Avg</th>
                <th class="px-4 py-2 text-right" data-tooltip="Giá trị vốn hóa thị trường">Market Cap</th>
                <th class="px-4 py-2">Hành động</th>
              </tr>
            </thead>
            <tbody id="screenerTbody"></tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="investment-systemSection" class="tab-section hidden fade-in">
      <div class="glass p-6 rounded-2xl shadow">
        <h2 class="text-2xl font-bold text-gradient"><i class="fa-solid fa-brain mr-2"></i>Hệ thống đầu tư</h2>
        <p class="text-sm text-gray-500 mt-2">Tìm hiểu về phương pháp, quản trị rủi ro và kiến thức đầu tư của chúng tôi.</p>
        <div class="mt-6 space-y-8">
            <div>
                <h3 class="text-lg font-semibold flex items-center"><i class="fa-solid fa-chart-pie mr-2 text-indigo-500"></i>Phương pháp đầu tư</h3>
                <p class="mt-2 text-gray-700 dark:text-gray-300">
                    Chúng tôi áp dụng một phương pháp đầu tư kết hợp giữa phân tích cơ bản (Fundamental Analysis) và phân tích kỹ thuật (Technical Analysis).
                </p>
                <ul class="list-disc list-inside mt-2 text-gray-600 dark:text-gray-400">
                    <li>**Phân tích cơ bản:** Đánh giá sức khỏe tài chính, mô hình kinh doanh và triển vọng tăng trưởng của doanh nghiệp.</li>
                    <li>**Phân tích kỹ thuật:** Sử dụng biểu đồ để xác định xu hướng, điểm vào/ra tối ưu.</li>
                </ul>
            </div>
            <div>
                <h3 class="text-lg font-semibold flex items-center"><i class="fa-solid fa-shield-halved mr-2 text-teal-500"></i>Quản trị rủi ro</h3>
                <p class="mt-2 text-gray-700 dark:text-gray-300">
                    Quản trị rủi ro là yếu tố then chốt để bảo vệ vốn và duy trì lợi nhuận.
                </p>
                <ul class="list-disc list-inside mt-2 text-gray-600 dark:text-gray-400">
                    <li>**Đa dạng hóa danh mục:** Phân bổ vốn vào nhiều loại tài sản để giảm thiểu rủi ro.</li>
                    <li>**Cắt lỗ (Stop-loss):** Luôn thiết lập ngưỡng cắt lỗ rõ ràng để hạn chế thua lỗ.</li>
                    <li>**Quản lý vị thế:** Điều chỉnh quy mô vị thế phù hợp với mức độ rủi ro chấp nhận.</li>
                </ul>
            </div>
        </div>
      </div>
    </section>

    <section id="watchlistSection" class="tab-section hidden fade-in">
      <div class="glass p-6 rounded-2xl shadow mb-6">
        <h2 class="text-2xl font-bold text-gradient"><i class="fa-solid fa-eye mr-2"></i>Theo dõi</h2>
        <p class="text-sm text-gray-500">Thêm mã bạn muốn theo dõi.</p>
        <div class="mt-4 flex gap-2">
          <input id="watchInput" type="text" class="rounded-md p-2 border w-full dark:border-gray-700 bg-transparent ring-gradient" placeholder="Nhập mã, ví dụ: VIC" />
          <button id="addWatchBtn" class="px-4 py-2 rounded-md bg-gradient-to-r from-indigo-600 to-teal-400 text-white font-medium hover:opacity-90 transition-opacity">Thêm</button>
        </div>
      </div>
      <div class="glass rounded-2xl p-4 shadow">
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm">
            <thead class="text-left text-gray-500">
              <tr><th class="px-4 py-2">Mã</th><th class="px-4 py-2">Giá</th><th class="px-4 py-2">% Thay đổi</th><th class="px-4 py-2">Hành động</th></tr>
            </thead>
            <tbody id="watchlistTbody"></tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="contactSection" class="tab-section hidden fade-in">
      <div class="glass p-6 rounded-2xl shadow">
        <h2 class="text-2xl font-bold text-gradient"><i class="fa-solid fa-envelope mr-2"></i>Liên hệ với chúng tôi</h2>
        <p class="text-sm text-gray-500 mt-2">Nếu bạn có bất kỳ câu hỏi hoặc cần hỗ trợ, vui lòng liên hệ với chúng tôi qua các kênh sau.</p>
        <div class="mt-6 space-y-4">
            <div>
                <h3 class="text-lg font-semibold flex items-center"><i class="fa-solid fa-phone mr-2 text-indigo-500"></i>Thông tin liên hệ</h3>
                <ul class="mt-2 space-y-2 text-gray-700 dark:text-gray-300">
                    <li><strong>Email:</strong> support@yatcapital.com</li>
                    <li><strong>Điện thoại:</strong> +84 987 654 321</li>
                    <li><strong>Địa chỉ:</strong> Tòa nhà ABC, Phường 1, Quận 1, TP. Hồ Chí Minh</li>
                </ul>
            </div>
            <div>
                <h3 class="text-lg font-semibold flex items-center"><i class="fa-solid fa-share-nodes mr-2 text-teal-500"></i>Mạng xã hội</h3>
                <ul class="mt-2 space-y-2 text-gray-700 dark:text-gray-300">
                    <li><strong>Facebook:</strong> <a href="#" class="text-blue-500 hover:underline">facebook.com/yatcapital</a></li>
                    <li><strong>LinkedIn:</strong> <a href="#" class="text-blue-500 hover:underline">linkedin.com/company/yatcapital</a></li>
                </ul>
            </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="text-center text-sm text-gray-500 py-8 fade-in">
    <div>Prototype — Không phải lời khuyên đầu tư. Mẫu lấy cảm hứng từ Solid State (HTML5UP).</div>
  </footer>

  <div id="stockModal" class="modal-overlay hidden">
    <div class="modal-content dark:bg-gray-800 p-6 rounded-xl shadow-lg relative">
      <button id="closeModalBtn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 dark:hover:text-gray-200 transition-colors"><i class="fa-solid fa-xmark fa-xl"></i></button>
      <h3 id="modalTitle" class="text-2xl font-bold mb-4 text-gradient">Stock Details</h3>
      <div id="modalContent" class="space-y-4">
        </div>
    </div>
  </div>

<script>
// Time update & dynamic mock data
const updatedTimeEl = document.getElementById('updatedTime');
const vnIndexVal = document.getElementById('vnIndexVal');
const spVal = document.getElementById('spVal');
const fxVal = document.getElementById('fxVal');
const vnIndexChange = document.getElementById('vnIndexChange');
const spChange = document.getElementById('spChange');
const fxChange = document.getElementById('fxChange');

function updateMarketData() {
  updatedTimeEl.innerText = new Date().toLocaleString('vi-VN', {hour: '2-digit', minute:'2-digit', second: '2-digit'});
  
  // Simulate random changes
  let vnChange = (Math.random() * 2 - 1).toFixed(2);
  let spChangeVal = (Math.random() * 1.5 - 0.75).toFixed(2);
  let fxChangeVal = (Math.random() * 0.5 - 0.25).toFixed(2);

  vnIndexVal.innerText = (1234.56 + parseFloat(vnChange) * 10).toFixed(2);
  spVal.innerText = (4567 + parseFloat(spChangeVal) * 5).toFixed(0);
  fxVal.innerText = (23600 + parseFloat(fxChangeVal) * 10).toFixed(0);

  vnIndexChange.innerText = `${vnChange}% (24h)`;
  spChange.innerText = `${spChangeVal}% (24h)`;
  fxChange.innerText = `${fxChangeVal}% (24h)`;

  vnIndexChange.classList.toggle('text-green-500', parseFloat(vnChange) >= 0);
  vnIndexChange.classList.toggle('text-red-500', parseFloat(vnChange) < 0);
  spChange.classList.toggle('text-green-500', parseFloat(spChangeVal) >= 0);
  spChange.classList.toggle('text-red-500', parseFloat(spChangeVal) < 0);
  fxChange.classList.toggle('text-green-500', parseFloat(fxChangeVal) >= 0);
  fxChange.classList.toggle('text-red-500', parseFloat(fxChangeVal) < 0);
}
updateMarketData();
setInterval(updateMarketData, 5000);

// Tab system
(function(){
  const tabs = document.querySelectorAll('.tab-btn');
  const sections = {
    overview: document.getElementById('overviewSection'),
    screener: document.getElementById('screenerSection'),
    'investment-system': document.getElementById('investment-systemSection'),
    watchlist: document.getElementById('watchlistSection'),
    contact: document.getElementById('contactSection')
  };
  function showTab(name){
    Object.keys(sections).forEach(k=>{
      const el = sections[k];
      if(el) {
        if(k === name){
          el.classList.remove('hidden');
          setTimeout(() => el.classList.remove('fade-in'), 10);
        } else {
          el.classList.add('hidden');
          el.classList.add('fade-in');
        }
      }
    });
    tabs.forEach(t=> {
      if(t.dataset.tab === name) {
        t.classList.add('border-b-indigo-600', 'text-indigo-600', 'dark:text-indigo-400');
        t.classList.remove('border-transparent');
      } else {
        t.classList.remove('border-b-indigo-600', 'text-indigo-600', 'dark:text-indigo-400');
        t.classList.add('border-transparent');
      }
    });
  }
  tabs.forEach(t=> t.addEventListener('click', ()=> showTab(t.dataset.tab)));
  showTab('overview');
})();

// Market Chart
const ctx = document.getElementById('marketChart').getContext('2d');
let marketChart;
const mockLabels = { '1D':['9:00','10:00','11:00','12:00','13:00','14:00','15:00'], '1W':['Mon','Tue','Wed','Thu','Fri','Sat','Sun'], '1M': ['W1','W2','W3','W4'], '1Y':['Jan','Mar','May','Jul','Sep','Nov'] };
const mockDataSets = {
  vn: { label:'VN-Index', data: [1200,1215,1190,1220,1234,1228,1234] },
  sp: { label:'S&P 500', data: [4500,4520,4510,4535,4567,4550,4567] }
};
function createMarketChart(type='line', interval='1W'){
  if(marketChart) marketChart.destroy();
  const labels = mockLabels[interval] || mockLabels['1W'];
  marketChart = new Chart(ctx, {
    type: type,
    data: {
      labels: labels,
      datasets: [
        { ...mockDataSets.vn, data: mockDataSets.vn.data.slice(0, labels.length), tension: 0.3, fill: true, borderWidth: 2, borderColor: '#4f46e5' },
        { ...mockDataSets.sp, data: mockDataSets.sp.data.slice(0, labels.length), tension: 0.3, borderWidth: 2, borderDash: [6,4], borderColor: '#06b6d4' }
      ]
    },
    options: {
      responsive:true,
      plugins:{legend:{position:'top'}},
      scales:{y:{beginAtZero:false}},
      animation: { duration: 800, easing: 'easeOutQuart' }
    }
  });
}
createMarketChart('line','1W');

document.querySelectorAll('.time-btn').forEach(b=> b.addEventListener('click', ()=>{
  const interval = b.dataset.interval;
  const type = document.getElementById('chartType').value;
  createMarketChart(type, interval);
}));
document.getElementById('chartType').addEventListener('change', (e)=>{
  const interval = document.querySelector('.time-btn.active')?.dataset?.interval || '1W';
  createMarketChart(e.target.value, interval);
});

// Tooltip for table headers
document.querySelectorAll('th[data-tooltip]').forEach(th => {
  th.style.cursor = 'pointer';
  th.addEventListener('mouseenter', function(e) {
    const tooltip = document.createElement('div');
    tooltip.className = 'absolute z-50 p-2 text-xs text-white bg-gray-800 rounded-md shadow-md';
    tooltip.innerText = this.dataset.tooltip;
    document.body.appendChild(tooltip);
    const rect = e.target.getBoundingClientRect();
    tooltip.style.left = `${rect.left + rect.width / 2 - tooltip.offsetWidth / 2}px`;
    tooltip.style.top = `${rect.bottom + 5}px`;
    this.dataset.tooltipElement = 'true';
  });
  th.addEventListener('mouseleave', function() {
    document.querySelectorAll('.absolute.z-50').forEach(el => el.remove());
    this.dataset.tooltipElement = 'false';
  });
});

// Screener mock with loading state & modal
const mockStocks = [
  {ticker:'VIC', name:'Vingroup', pe:12.5, eps: 5000, roe:18.2, be: 2.1, peAvg: 14.5, marketCap:50000, sector:'Real Estate'},
  {ticker:'PNJ', name:'PNJ', pe:16.3, eps: 4500, roe:22.1, be: 3.5, peAvg: 18.0, marketCap:15000, sector:'Retail'},
  {ticker:'FPT', name:'FPT', pe:14.8, eps: 6000, roe:15.0, be: 2.8, peAvg: 15.5, marketCap:25000, sector:'IT'},
  {ticker:'HPG', name:'HPG', pe:8.2, eps: 2500, roe:12.0, be: 1.5, peAvg: 10.0, marketCap:30000, sector:'Manufacturing'},
  {ticker:'SSI', name:'SSI Securities', pe:20.5, eps: 3000, roe:8.5, be: 1.2, peAvg: 18.5, marketCap:8000, sector:'Finance'}
];
const stockModal = document.getElementById('stockModal');
const closeModalBtn = document.getElementById('closeModalBtn');
const modalTitle = document.getElementById('modalTitle');
const modalContent = document.getElementById('modalContent');
closeModalBtn.addEventListener('click', () => stockModal.classList.add('hidden'));

function showModal(stock){
  stockModal.classList.remove('hidden');
  modalTitle.innerText = `${stock.ticker} - ${stock.name}`;
  modalContent.innerHTML = `
    <div class="grid grid-cols-2 gap-4">
      <div><strong>P/E:</strong> ${stock.pe.toFixed(1)}</div>
      <div><strong>EPS:</strong> ${stock.eps.toLocaleString()} VND</div>
      <div><strong>ROE:</strong> ${stock.roe.toFixed(1)}%</div>
      <div><strong>B/E:</strong> ${stock.be.toFixed(1)}</div>
      <div><strong>P/E Avg:</strong> ${stock.peAvg.toFixed(1)}</div>
      <div><strong>Market Cap:</strong> ${stock.marketCap.toLocaleString()} Tỷ VND</div>
      <div><strong>Sector:</strong> ${stock.sector}</div>
    </div>
    <div class="mt-4 text-sm text-gray-500 italic">Đây là dữ liệu mô phỏng</div>
  `;
}

function buildTable(rows){
  const tbody = document.getElementById('screenerTbody');
  tbody.innerHTML = '';
  if(rows.length === 0){
    tbody.innerHTML = `<tr><td colspan="9" class="text-center py-6 text-gray-500">Không có kết quả nào phù hợp</td></tr>`;
    return;
  }
  rows.forEach(r=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="px-4 py-2 font-medium">${r.ticker}</td>
      <td class="px-4 py-2">${r.name}</td>
      <td class="px-4 py-2 text-right">${r.pe.toFixed(1)}</td>
      <td class="px-4 py-2 text-right">${r.eps.toLocaleString()}</td>
      <td class="px-4 py-2 text-right">${r.roe.toFixed(1)}%</td>
      <td class="px-4 py-2 text-right">${r.be.toFixed(1)}</td>
      <td class="px-4 py-2 text-right">${r.peAvg.toFixed(1)}</td>
      <td class="px-4 py-2 text-right">${(r.marketCap).toLocaleString()}</td>
      <td class="px-4 py-2"><button class="text-indigo-600 hover:underline view-btn" data-ticker="${r.ticker}">View</button></td>
    `;
    tbody.appendChild(tr);
  });
  document.querySelectorAll('.view-btn').forEach(b=> b.addEventListener('click', (e)=> {
    const stock = mockStocks.find(s => s.ticker === e.target.dataset.ticker);
    if(stock) showModal(stock);
  }));
}

document.getElementById('runScreenerBtn').addEventListener('click', ()=>{
  const runBtnText = document.getElementById('runBtnText');
  const runBtnSpinner = document.getElementById('runBtnSpinner');
  runBtnText.classList.add('hidden');
  runBtnSpinner.classList.remove('hidden');

  setTimeout(() => {
    const peMax = parseFloat(document.getElementById('peInput').value) || Infinity;
    const epsMin = parseFloat(document.getElementById('epsInput').value) || -Infinity;
    const roeMin = parseFloat(document.getElementById('roeInput').value) || -Infinity;
    const beMax = parseFloat(document.getElementById('beInput').value) || Infinity;
    const peAvgMax = parseFloat(document.getElementById('peAvgInput').value) || Infinity;
    const sector = document.getElementById('sectorInput').value;
    const results = mockStocks.filter(s => s.pe <= peMax && s.eps >= epsMin && s.roe >= roeMin && s.be <= beMax && s.peAvg <= peAvgMax && (sector? s.sector === sector: true));
    buildTable(results);
    runBtnText.classList.remove('hidden');
    runBtnSpinner.classList.add('hidden');
  }, 1000);
});
document.getElementById('resetScreenerBtn').addEventListener('click', ()=>{
  document.getElementById('peInput').value='';
  document.getElementById('epsInput').value='';
  document.getElementById('roeInput').value='';
  document.getElementById('beInput').value='';
  document.getElementById('peAvgInput').value='';
  document.getElementById('sectorInput').value='';
  buildTable(mockStocks);
});
buildTable(mockStocks);

// Watchlist handlers
let watchlist = [{ticker:'VIC', price:120000, change:'+1.2%'}, {ticker:'HPG', price:42000, change:'-0.5%'}];
function renderWatch(){
  const tbody = document.getElementById('watchlistTbody'); tbody.innerHTML='';
  watchlist.forEach((w,idx)=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td class="px-4 py-2 font-medium">${w.ticker}</td><td class="px-4 py-2">${w.price.toLocaleString()}</td><td class="px-4 py-2">${w.change}</td><td class="px-4 py-2"><button class="text-red-600 hover:underline remove-watch" data-idx="${idx}">Remove</button></td>`;
    tbody.appendChild(tr);
  });
  document.querySelectorAll('.remove-watch').forEach(b=> b.addEventListener('click', e=> { watchlist.splice(e.target.dataset.idx,1); renderWatch(); }));
}
document.getElementById('addWatchBtn').addEventListener('click', ()=>{
  const v = document.getElementById('watchInput').value.trim().toUpperCase();
  if(!v) return alert('Nhập mã hợp lệ');
  watchlist.unshift({ticker:v, price:10000, change:'+0.0%'});
  document.getElementById('watchInput').value='';
  renderWatch();
});
renderWatch();
</script>
</body>
</html>