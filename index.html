<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Y&T Capital - Website Prototype</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --accent-from: #4f46e5;
      --accent-to: #06b6d4;
    }
    body { font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; }
.hero-bg {
    background-image: url('images/pic0001.jpg');
    background-size: cover;
    background-position: center;
}
    .glass { backdrop-filter: blur(6px); background-color: rgba(255, 255, 255, 0.6); }
    @media (prefers-color-scheme: dark) {
      .glass { background-color: rgba(17, 24, 39, 0.5); }
    }
    
    /* Animations */
    .fade-in { animation: fadeIn 0.5s ease-out forwards; opacity: 0; }
    .slide-up { animation: slideUp 0.6s ease-out forwards; opacity: 0; transform: translateY(20px); }
    .slide-up-1 { animation-delay: 0.1s; }
    .slide-up-2 { animation-delay: 0.2s; }
    .slide-up-3 { animation-delay: 0.3s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    /* Hover effects */
    .hover-grow { transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
    .hover-grow:hover { transform: translateY(-4px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
    
    /* Custom styles */
    .tab-section.hidden { display: none; }
    .text-gradient { background-image: linear-gradient(to right, var(--accent-from), var(--accent-to)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .ring-gradient:focus { outline: none; box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.5); }
    .tab-btn.active, .tab-btn.active:hover { border-bottom-color: var(--accent-from); color: #4f46e5; }
    .time-btn.active, .time-btn.active:hover { background-color: #e0e7ff; color: #4338ca; border-color: #4338ca; }
    .dark .time-btn.active, .dark .time-btn.active:hover { background-color: #1e293b; color: #6366f1; border-color: #6366f1; }
    
    /* Subtab styles */
    .subtab-btn.active, .subtab-btn.active:hover {
        border-bottom-color: var(--accent-from);
        color: #4f46e5;
        font-weight: 600;
    }
    .dark .subtab-btn.active, .dark .subtab-btn.active:hover {
        color: #6366f1;
    }
    .subtab-section.hidden {
        display: none;
    }

    /* Modal */
    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); display: flex; justify-content: center; align-items: center; z-index: 1000; }
    .modal-content { background-color: #fff; padding: 2rem; border-radius: 1rem; max-width: 500px; width: 100%; position: relative; }
    .modal-content.dark { background-color: #1f2937; color: #f3f4f6; }
    .tooltip { position: absolute; z-index: 1001; padding: 0.5rem; background-color: #374151; color: #f9fafb; border-radius: 0.375rem; font-size: 0.75rem; white-space: nowrap; transition: opacity 0.2s ease; opacity: 0; pointer-events: none; }
    .tooltip.visible { opacity: 1; }
  </style>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100">

  <header class="hero-bg border-b border-gray-200 dark:border-gray-800 slide-up slide-up-1">
    <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
      <a href="#" class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-indigo-600 to-teal-400 flex items-center justify-center text-white font-bold text-lg">Y</div>
        <div>
          <div class="text-lg font-bold">Y&T Capital</div>
          <div class="text-xs text-gray-500 dark:text-gray-400">Website Prototype</div>
        </div>
      </a>
      <nav class="hidden md:flex items-center gap-2 text-sm" role="tablist" aria-label="Main Tabs">
        <button data-tab="about-us" class="tab-btn px-3 py-2 rounded-md border-b-2 border-transparent transition-colors duration-200 ease-in-out" role="tab"><i class="fa-solid fa-info-circle mr-2"></i>Về chúng tôi</button>
        <button data-tab="screener" class="tab-btn px-3 py-2 rounded-md border-b-2 border-transparent transition-colors duration-200 ease-in-out" role="tab"><i class="fa-solid fa-filter mr-2"></i>Bộ lọc cổ phiếu</button>
        <button data-tab="analysis" class="tab-btn px-3 py-2 rounded-md border-b-2 border-transparent transition-colors duration-200 ease-in-out" role="tab"><i class="fa-solid fa-magnifying-glass-chart mr-2"></i>Phân tích Doanh nghiệp</button>
        <button data-tab="investment-system" class="tab-btn px-3 py-2 rounded-md border-b-2 border-transparent transition-colors duration-200 ease-in-out" role="tab"><i class="fa-solid fa-brain mr-2"></i>Hệ thống đầu tư</button>
        <button data-tab="contact" class="tab-btn px-3 py-2 rounded-md border-b-2 border-transparent transition-colors duration-200 ease-in-out" role="tab"><i class="fa-solid fa-envelope mr-2"></i>Liên hệ</button>
      </nav>
    </div>
    <div class="md:hidden border-t border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-gray-900/60">
      <div class="max-w-7xl mx-auto px-4 py-2 flex gap-2 overflow-x-auto">
        <button data-tab="about-us" class="tab-btn px-3 py-2 rounded-md text-sm"><i class="fa-solid fa-info-circle"></i></button>
        <button data-tab="screener" class="tab-btn px-3 py-2 rounded-md text-sm"><i class="fa-solid fa-filter"></i></button>
        <button data-tab="analysis" class="tab-btn px-3 py-2 rounded-md text-sm"><i class="fa-solid fa-magnifying-glass-chart"></i></button>
        <button data-tab="investment-system" class="tab-btn px-3 py-2 rounded-md text-sm"><i class="fa-solid fa-brain"></i></button>
        <button data-tab="contact" class="tab-btn px-3 py-2 rounded-md text-sm"><i class="fa-solid fa-envelope"></i></button>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-6 py-8">
    <section id="about-usSection" class="tab-section fade-in slide-up-1">
      <div class="glass p-6 rounded-2xl shadow">
        <h2 class="text-2xl font-bold text-gradient"><i class="fa-solid fa-info-circle mr-2"></i>Về chúng tôi</h2>
        <div class="mt-6 space-y-8">
            <div>
                <h3 class="text-xl font-semibold flex items-center mb-2"><i class="fa-solid fa-lightbulb mr-2 text-indigo-500"></i>Tầm nhìn</h3>
                <p class="text-gray-700 dark:text-gray-300">
                    Trở thành đối tác tài chính tin cậy, đồng hành cùng khách hàng đạt được mục tiêu thịnh vượng bền vững thông qua các giải pháp đầu tư thông minh và hiệu quả.
                </p>
            </div>
            
            <div>
                <h3 class="text-xl font-semibold flex items-center mb-2"><i class="fa-solid fa-bullseye mr-2 text-teal-500"></i>Sứ mệnh</h3>
                <p class="text-gray-700 dark:text-gray-300">
                    Cung cấp các sản phẩm và dịch vụ đầu tư chất lượng cao, dựa trên nền tảng phân tích chuyên sâu và quản trị rủi ro chặt chẽ. Chúng tôi cam kết mang lại sự minh bạch, an toàn và lợi nhuận tối ưu cho mọi khách hàng.
                </p>
            </div>

            <div>
                <h3 class="text-xl font-semibold flex items-center mb-2"><i class="fa-solid fa-users mr-2 text-purple-500"></i>Đội ngũ</h3>
                <p class="text-gray-700 dark:text-gray-300">
                    Đội ngũ của chúng tôi bao gồm các chuyên gia tài chính giàu kinh nghiệm, am hiểu sâu sắc về thị trường. Với sự kết hợp giữa kiến thức chuyên môn và sự tận tâm, chúng tôi luôn nỗ lực để mang lại những quyết định đầu tư sáng suốt nhất.
                </p>
                <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="p-4 bg-white dark:bg-gray-800 rounded-xl shadow-sm">
                      <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
    <div class="p-4 bg-white dark:bg-gray-800 rounded-xl shadow-sm text-center">
        <img src="images/AVR001.jpg" 
             alt="Avatar Trần Minh Nhật" 
               class="w-32 h-32 object-cover rounded-full mx-auto">
                        <h4 class="font-bold">Trần Minh Nhật</h4>
                        <p class="text-sm text-gray-500">CEO & Founder</p>
                    </div>
                    <div class="p-4 bg-white dark:bg-gray-800 rounded-xl shadow-sm text-center">
                      <img src="images/AVR002.jpg" 
             alt="Avatar Phạm Phương Nga" 
               class="w-32 h-32 object-cover rounded-full mx-auto">
                        <h4 class="font-bold">Phạm Phương Nga</h4>
                        <p class="text-sm text-gray-500">Co-Founder </p>
                        <div class="p-4 bg-white dark:bg-gray-800 rounded-xl shadow-sm text-center">
        <img src="images/AVR001.jpg" 
             alt="Avatar Nguyễn Nhất Bảo" 
               class="w-32 h-32 object-cover rounded-full mx-auto">
                        <h4 class="font-bold">Nguyễn Nhất Bảo</h4>
                        <p class="text-sm text-gray-500">C0-Founder</p>
                    </div>
                    </div>
                </div>
            </div>
        </div>
      </div>
    </section>

    <section id="screenerSection" class="tab-section hidden fade-in">
      <div class="glass p-6 rounded-2xl shadow mb-6">
        <h2 class="text-2xl font-bold text-gradient"><i class="fa-solid fa-filter mr-2"></i>Bộ lọc cổ phiếu</h2>
        <p class="text-sm text-gray-500">Nhập tiêu chí để lọc (dữ liệu mô phỏng).</p>
        <div class="mt-4 grid grid-cols-1 md:grid-cols-6 gap-4 items-end">
          <div>
            <label class="block text-gray-600 dark:text-gray-300 text-sm">P/E ≤</label>
            <input id="peInput" type="number" class="mt-1 w-full rounded-md border-gray-200 dark:border-gray-700 p-2 bg-transparent ring-gradient" placeholder="e.g. 15" />
          </div>
          <div>
            <label class="block text-gray-600 dark:text-gray-300 text-sm">EPS ≥</label>
            <input id="epsInput" type="number" class="mt-1 w-full rounded-md border-gray-200 dark:border-gray-700 p-2 bg-transparent ring-gradient" placeholder="e.g. 4000" />
          </div>
          <div>
            <label class="block text-gray-600 dark:text-gray-300 text-sm">ROE ≥</label>
            <input id="roeInput" type="number" class="mt-1 w-full rounded-md border-gray-200 dark:border-gray-700 p-2 bg-transparent ring-gradient" placeholder="e.g. 15" />
          </div>
          <div>
            <label class="block text-gray-600 dark:text-gray-300 text-sm">B/E ≤</label>
            <input id="beInput" type="number" class="mt-1 w-full rounded-md border-gray-200 dark:border-gray-700 p-2 bg-transparent ring-gradient" placeholder="e.g. 15" />
          </div>
          <div>
            <label class="block text-gray-600 dark:text-gray-300 text-sm">P/E average ≤</label>
            <input id="peAvgInput" type="number" class="mt-1 w-full rounded-md border-gray-200 dark:border-gray-700 p-2 bg-transparent ring-gradient" placeholder="e.g. 15" />
          </div>
          <div>
            <label class="block text-gray-600 dark:text-gray-300 text-sm">Sector</label>
            <select id="sectorInput" class="mt-1 w-full rounded-md border-gray-200 dark:border-gray-700 p-2 bg-transparent text-sm ring-gradient">
              <option value="">All</option><option>Finance</option><option>IT</option><option>Retail</option><option>Real Estate</option>
            </select>
          </div>
          <div class="md:col-span-2 flex gap-2">
            <button id="runScreenerBtn" class="w-full py-2 rounded-md bg-gradient-to-r from-indigo-600 to-teal-400 text-white font-medium hover:opacity-90 transition-opacity">
              <span id="runBtnText">Run</span>
              <i id="runBtnSpinner" class="fas fa-spinner fa-spin ml-2 hidden"></i>
            </button>
            <button id="resetScreenerBtn" class="w-full py-2 rounded-md border border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Reset</button>
          </div>
        </div>
      </div>
      <div class="glass rounded-2xl p-4 shadow">
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm" aria-label="Screener results">
            <thead class="text-left text-gray-500">
              <tr>
                <th class="px-4 py-2" data-tooltip="Mã cổ phiếu">Mã</th>
                <th class="px-4 py-2" data-tooltip="Tên công ty">Tên</th>
                <th class="px-4 py-2 text-right" data-tooltip="Giá trên thu nhập (Price-to-Earnings)">P/E</th>
                <th class="px-4 py-2 text-right" data-tooltip="Thu nhập trên mỗi cổ phiếu (Earnings Per Share)">EPS</th>
                <th class="px-4 py-2 text-right" data-tooltip="Lợi nhuận trên vốn chủ sở hữu (Return On Equity)">ROE</th>
                <th class="px-4 py-2 text-right" data-tooltip="Tỷ lệ giá trên giá trị sổ sách (Price-to-Book)">B/E</th>
                <th class="px-4 py-2 text-right" data-tooltip="Giá trên thu nhập trung bình">P/E Avg</th>
                <th class="px-4 py-2 text-right" data-tooltip="Giá trị vốn hóa thị trường">Market Cap</th>
                <th class="px-4 py-2">Hành động</th>
              </tr>
            </thead>
            <tbody id="screenerTbody"></tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="analysisSection" class="tab-section hidden fade-in">
      <div class="glass p-6 rounded-2xl shadow grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="md:col-span-2">
          <h2 class="text-2xl font-bold text-gradient"><i class="fa-solid fa-magnifying-glass-chart mr-2"></i>Phân tích Doanh nghiệp</h2>
          <p class="text-sm text-gray-500 mt-2">Báo cáo phân tích chuyên sâu (dữ liệu tĩnh).</p>
          <div class="mt-4 flex gap-2 items-center max-w-sm">
            <input id="stockAnalysisInput" type="text" class="rounded-md p-2 border w-full dark:border-gray-700 bg-transparent ring-gradient" placeholder="Nhập mã chứng khoán, ví dụ: VIC" />
            <button id="searchAnalysisBtn" class="px-4 py-2 rounded-md bg-gradient-to-r from-indigo-600 to-teal-400 text-white font-medium hover:opacity-90 transition-opacity whitespace-nowrap">Tìm kiếm</button>
          </div>
          <div id="analysisReportContainer" class="mt-6">
            <div class="p-6 bg-white dark:bg-gray-800 rounded-xl shadow-md text-center text-gray-500">
                Hãy nhập mã cổ phiếu để xem báo cáo phân tích.
            </div>
          </div>
        </div>
        <aside class="space-y-6">
          <div class="glass p-4 rounded-2xl shadow">
            <h4 class="font-bold text-lg"><i class="fa-solid fa-bullhorn mr-2 text-red-500"></i>Tin hiệu gần đây</h4>
            <ul id="stockSignals" class="mt-3 text-sm space-y-2">
              <li>-</li>
            </ul>
          </div>
          <div class="glass p-4 rounded-2xl shadow">
            <h4 class="font-bold text-lg"><i class="fa-solid fa-chart-line mr-2 text-blue-500"></i>Mô hình Định giá</h4>
            <div id="stockValuation" class="mt-3 text-sm">
                <div class="flex justify-between font-medium"><span>Mức giá mục tiêu:</span> <span class="text-indigo-500 font-bold">-</span></div>
                <div class="flex justify-between text-gray-500"><span>Giá trị hiện tại:</span> <span>-</span></div>
                <div class="flex justify-between text-gray-500"><span>Chiết khấu:</span> <span>-</span></div>
            </div>
            <p class="mt-4 text-sm text-gray-500 italic">Bạn có thể điều chỉnh các biến số tăng trưởng, chiết khấu để tự định giá.</p>
          </div>
        </aside>
      </div>
    </section>
    
    <section id="investment-systemSection" class="tab-section hidden fade-in">
      <div class="glass p-6 rounded-2xl shadow">
        <h2 class="text-2xl font-bold text-gradient"><i class="fa-solid fa-brain mr-2"></i>Hệ thống đầu tư</h2>
        <p class="text-sm text-gray-500 mt-2">Tìm hiểu về phương pháp, quản trị rủi ro và kiến thức đầu tư của chúng tôi.</p>
        
        <nav class="mt-4 flex gap-4 border-b border-gray-200 dark:border-gray-700" role="tablist">
          <button data-subtab="methodology" class="subtab-btn px-4 py-2 border-b-2 border-transparent transition-colors duration-200 ease-in-out active" role="tab">Phương pháp</button>
          <button data-subtab="risk" class="subtab-btn px-4 py-2 border-b-2 border-transparent transition-colors duration-200 ease-in-out" role="tab">Quản trị rủi ro</button>
          <button data-subtab="knowledge" class="subtab-btn px-4 py-2 border-b-2 border-transparent transition-colors duration-200 ease-in-out" role="tab">Kiến thức</button>
        </nav>

        <div id="subtab-content" class="mt-6">
          <div id="methodology-subtab" class="subtab-section">
            <h3 class="text-lg font-semibold flex items-center"><i class="fa-solid fa-chart-pie mr-2 text-indigo-500"></i>Phương pháp đầu tư</h3>
            <p class="mt-2 text-gray-700 dark:text-gray-300">
                Chúng tôi áp dụng một phương pháp đầu tư kết hợp giữa phân tích cơ bản (Fundamental Analysis) và phân tích kỹ thuật (Technical Analysis).
            </p>
            <ul class="list-disc list-inside mt-2 text-gray-600 dark:text-gray-400">
                <li>**Phân tích cơ bản:** Đánh giá sức khỏe tài chính, mô hình kinh doanh và triển vọng tăng trưởng của doanh nghiệp.</li>
                <li>**Phân tích kỹ thuật:** Sử dụng biểu đồ để xác định xu hướng, điểm vào/ra tối ưu.</li>
            </ul>
          </div>
          <div id="risk-subtab" class="subtab-section hidden">
            <h3 class="text-lg font-semibold flex items-center"><i class="fa-solid fa-shield-halved mr-2 text-teal-500"></i>Quản trị rủi ro</h3>
            <p class="mt-2 text-gray-700 dark:text-gray-300">
                Quản trị rủi ro là yếu tố then chốt để bảo vệ vốn và duy trì lợi nhuận.
            </p>
            <ul class="list-disc list-inside mt-2 text-gray-600 dark:text-gray-400">
                <li>**Đa dạng hóa danh mục:** Phân bổ vốn vào nhiều loại tài sản để giảm thiểu rủi ro.</li>
                <li>**Cắt lỗ (Stop-loss):** Luôn thiết lập ngưỡng cắt lỗ rõ ràng để hạn chế thua lỗ.</li>
                <li>**Quản lý vị thế:** Điều chỉnh quy mô vị thế phù hợp với mức độ rủi ro chấp nhận.</li>
            </ul>
          </div>
          <div id="knowledge-subtab" class="subtab-section hidden">
            <h3 class="text-lg font-semibold flex items-center"><i class="fa-solid fa-book-open mr-2 text-purple-500"></i>Kiến thức đầu tư</h3>
            <p class="mt-2 text-gray-700 dark:text-gray-300">
                Phần này sẽ cung cấp các tài liệu và bài viết chuyên sâu về đầu tư.
            </p>
            <ul class="list-disc list-inside mt-2 text-gray-600 dark:text-gray-400">
                <li>Cẩm nang phân tích báo cáo tài chính.</li>
                <li>Hướng dẫn sử dụng các chỉ báo kỹ thuật cơ bản.</li>
                <li>Bài viết về tâm lý giao dịch và kỷ luật.</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <section id="contactSection" class="tab-section hidden fade-in">
      <div class="glass p-6 rounded-2xl shadow">
        <h2 class="text-2xl font-bold text-gradient"><i class="fa-solid fa-envelope mr-2"></i>Liên hệ với chúng tôi</h2>
        <p class="text-sm text-gray-500 mt-2">Nếu bạn có bất kỳ câu hỏi hoặc cần hỗ trợ, vui lòng liên hệ với chúng tôi qua các kênh sau.</p>
        <div class="mt-6 space-y-4">
            <div>
                <h3 class="text-lg font-semibold flex items-center"><i class="fa-solid fa-phone mr-2 text-indigo-500"></i>Thông tin liên hệ</h3>
                <ul class="mt-2 space-y-2 text-gray-700 dark:text-gray-300">
                    <li><strong>Email:</strong> mntnhat1009@gmail.com</li>
                    <li><strong>Điện thoại:</strong> +84 822 082 407</li>
                    <li><strong>Địa chỉ:</strong> 92, 19E, Phường An Lạc, TP. Hồ Chí Minh</li>
                </ul>
            </div>
            <div>
                <h3 class="text-lg font-semibold flex items-center"><i class="fa-solid fa-share-nodes mr-2 text-teal-500"></i>Mạng xã hội</h3>
                <ul class="mt-2 space-y-2 text-gray-700 dark:text-gray-300">
                    <li><strong>Facebook:</strong> <a href="#" class="text-blue-500 hover:underline">facebook.com/Y&Tcapital</a></li>
                    <li><strong>LinkedIn:</strong> <a href="#" class="text-blue-500 hover:underline">linkedin.com/company/Y&Tcapital</a></li>
                </ul>
            </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="text-center text-sm text-gray-500 py-8 fade-in">
    <div>Copyright © 2025 Y&TCapital. All rights reserved.</div>
  </footer>

  <div id="globalTooltip" class="tooltip"></div>

<script>
// Main Tab system
(function(){
  const tabs = document.querySelectorAll('.tab-btn');
  const sections = {
    'about-us': document.getElementById('about-usSection'),
    screener: document.getElementById('screenerSection'),
    analysis: document.getElementById('analysisSection'),
    'investment-system': document.getElementById('investment-systemSection'),
    contact: document.getElementById('contactSection')
  };
  function showTab(name){
    Object.keys(sections).forEach(k=>{
      const el = sections[k];
      if(el) {
        if(k === name){
          el.classList.remove('hidden');
        } else {
          el.classList.add('hidden');
        }
      }
    });
    tabs.forEach(t=> {
      if(t.dataset.tab === name) {
        t.classList.add('active');
        t.classList.remove('border-transparent');
      } else {
        t.classList.remove('active');
        t.classList.add('border-transparent');
      }
    });
  }
  tabs.forEach(t=> t.addEventListener('click', ()=> showTab(t.dataset.tab)));
  showTab('about-us');
  window.showTab = showTab; // Expose to global scope for other scripts
})();

// Sub-tab system for Investment System section
(function() {
  const subtabs = document.querySelectorAll('#investment-systemSection .subtab-btn');
  const sections = {
    'methodology': document.getElementById('methodology-subtab'),
    'risk': document.getElementById('risk-subtab'),
    'knowledge': document.getElementById('knowledge-subtab')
  };

  function showSubTab(name) {
    Object.keys(sections).forEach(k => {
      const el = sections[k];
      if (el) {
        if (k === name) {
          el.classList.remove('hidden');
        } else {
          el.classList.add('hidden');
        }
      }
    });
    subtabs.forEach(t => {
      if (t.dataset.subtab === name) {
        t.classList.add('active');
      } else {
        t.classList.remove('active');
      }
    });
  }
  
  subtabs.forEach(t => t.addEventListener('click', () => showSubTab(t.dataset.subtab)));
  showSubTab('methodology'); // Show default subtab on load
})();

// Tooltip for table headers (optimized)
const globalTooltip = document.getElementById('globalTooltip');
document.querySelectorAll('th[data-tooltip]').forEach(th => {
  th.style.cursor = 'pointer';
  th.addEventListener('mouseenter', function(e) {
    globalTooltip.innerText = this.dataset.tooltip;
    const rect = e.target.getBoundingClientRect();
    globalTooltip.style.left = `${rect.left + rect.width / 2 - globalTooltip.offsetWidth / 2}px`;
    globalTooltip.style.top = `${rect.bottom + 5}px`;
    globalTooltip.classList.add('visible');
  });
  th.addEventListener('mouseleave', function() {
    globalTooltip.classList.remove('visible');
  });
});

// Screener mock with loading state & modal
let mockStocks = [];
fetch("stocks.json")
  .then(res => res.json())
  .then(data => {
    mockStocks = data;
    buildTable(mockStocks);
  });
  function buildTable(rows){
  const tbody = document.getElementById('screenerTbody');
  tbody.innerHTML = '';
  if(rows.length === 0){
    tbody.innerHTML = `<tr><td colspan="9" class="text-center py-6 text-gray-500">Không có kết quả nào phù hợp</td></tr>`;
    return;
  }
  rows.forEach(r=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="px-4 py-2 font-medium">${r.ticker}</td>
      <td class="px-4 py-2">${r.name}</td>
      <td class="px-4 py-2 text-right">${r.pe.toFixed(1)}</td>
      <td class="px-4 py-2 text-right">${r.eps.toLocaleString()}</td>
      <td class="px-4 py-2 text-right">${r.roe.toFixed(1)}%</td>
      <td class="px-4 py-2 text-right">${r.be.toFixed(1)}</td>
      <td class="px-4 py-2 text-right">${r.peAvg.toFixed(1)}</td>
      <td class="px-4 py-2 text-right">${(r.marketCap).toLocaleString()}</td>
      <td class="px-4 py-2"><button class="text-indigo-600 hover:underline view-btn" data-ticker="${r.ticker}">View</button></td>
    `;
    tbody.appendChild(tr);
  });
  document.querySelectorAll('.view-btn').forEach(b=> b.addEventListener('click', (e)=> {
    const ticker = e.target.dataset.ticker;
    viewAnalysis(ticker);
  }));
}

document.getElementById('runScreenerBtn').addEventListener('click', ()=>{
  const runBtnText = document.getElementById('runBtnText');
  const runBtnSpinner = document.getElementById('runBtnSpinner');
  runBtnText.classList.add('hidden');
  runBtnSpinner.classList.remove('hidden');

  setTimeout(() => {
    const peMax = parseFloat(document.getElementById('peInput').value) || Infinity;
    const epsMin = parseFloat(document.getElementById('epsInput').value) || -Infinity;
    const roeMin = parseFloat(document.getElementById('roeInput').value) || -Infinity;
    const beMax = parseFloat(document.getElementById('beInput').value) || Infinity;
    const peAvgMax = parseFloat(document.getElementById('peAvgInput').value) || Infinity;
    const sector = document.getElementById('sectorInput').value;
    const results = mockStocks.filter(s => s.pe <= peMax && s.eps >= epsMin && s.roe >= roeMin && s.be <= beMax && s.peAvg <= peAvgMax && (sector? s.sector === sector: true));
    buildTable(results);
    runBtnText.classList.remove('hidden');
    runBtnSpinner.classList.add('hidden');
  }, 1000);
});
document.getElementById('resetScreenerBtn').addEventListener('click', ()=>{
  document.getElementById('peInput').value='';
  document.getElementById('epsInput').value='';
  document.getElementById('roeInput').value='';
  document.getElementById('beInput').value='';
  document.getElementById('peAvgInput').value='';
  document.getElementById('sectorInput').value='';
  buildTable(mockStocks);
});
buildTable(mockStocks);

// Analysis search handlers
const analysisInput = document.getElementById('stockAnalysisInput');
const searchAnalysisBtn = document.getElementById('searchAnalysisBtn');
const analysisReportContainer = document.getElementById('analysisReportContainer');
const stockSignalsList = document.getElementById('stockSignals');
const stockValuationDiv = document.getElementById('stockValuation');

function renderAnalysisReport(stock) {
    if (!stock) {
        analysisReportContainer.innerHTML = `<div class="p-6 bg-white dark:bg-gray-800 rounded-xl shadow-md text-center text-gray-500">
            Không tìm thấy báo cáo phân tích cho mã cổ phiếu này. Vui lòng thử lại với mã khác.
        </div>`;
        stockSignalsList.innerHTML = `<li>-</li>`;
        stockValuationDiv.innerHTML = `
            <div class="flex justify-between font-medium"><span>Mức giá mục tiêu:</span> <span class="text-indigo-500 font-bold">-</span></div>
            <div class="flex justify-between text-gray-500"><span>Giá trị hiện tại:</span> <span>-</span></div>
            <div class="flex justify-between text-gray-500"><span>Chiết khấu:</span> <span>-</span></div>
        `;
        return;
    }

    analysisReportContainer.innerHTML = `
        <div class="p-6 bg-white dark:bg-gray-800 rounded-xl shadow-md">
            <h3 class="text-xl font-bold">${stock.ticker} - ${stock.name}</h3>
            <p class="text-sm mt-2">${stock.description}</p>
            <div class="mt-3 text-sm grid grid-cols-2 gap-2">
                <div>**Market Cap:** ${stock.marketCap.toLocaleString()} Tỷ VND</div>
                <div>**Ngành:** ${stock.sector}</div>
                <div>**Giá trị nội tại:** ~${stock.intrinsicValue.toLocaleString()} VND</div>
                <div>**Khuyến nghị:** <span class="font-bold text-green-500">${stock.recommendation}</span></div>
            </div>
        </div>
        <div class="mt-6 space-y-6">
            <div class="p-6 bg-white dark:bg-gray-800 rounded-xl shadow-md">
                <h4 class="font-bold text-lg">Phân tích Cơ bản</h4>
                <p class="mt-2 text-sm text-gray-500">Biểu đồ thể hiện ROE (hiệu quả sử dụng vốn) và tăng trưởng doanh thu trong 5 năm gần nhất.</p>
                <div class="mt-4"><img src="https://via.placeholder.com/600x250.png?text=Bi%E1%BB%83u+%C4%91%E1%BB%93+ph%C3%A2n+t%C3%ADch+c%C6%A1+b%E1%BA%A3n+c%E1%BB%A7a+${stock.ticker}" alt="Biểu đồ phân tích cơ bản" class="w-full rounded-lg"></div>
                <p class="mt-4 text-sm font-semibold">Nhận định:</p>
                <p class="text-sm text-gray-700 dark:text-gray-300">${stock.fundamentalAnalysis}</p>
            </div>
            <div class="p-6 bg-white dark:bg-gray-800 rounded-xl shadow-md">
                <h4 class="font-bold text-lg">Phân tích Kỹ thuật</h4>
                <p class="mt-2 text-sm text-gray-500">Biểu đồ nến của ${stock.ticker} và các chỉ báo kỹ thuật quan trọng.</p>
                <div class="mt-4"><img src="https://via.placeholder.com/600x250.png?text=Bi%E1%BB%83u+%C4%91%E1%BB%93+ph%C3%A2n+t%C3%ADch+k%E1%BB%B9+thu%E1%BA%ADt+c%E1%BB%A7a+${stock.ticker}" alt="Biểu đồ phân tích kỹ thuật" class="w-full rounded-lg"></div>
                <p class="mt-4 text-sm font-semibold">Nhận định:</p>
                <p class="text-sm text-gray-700 dark:text-gray-300">${stock.technicalAnalysis}</p>
            </div>
        </div>
    `;

    stockSignalsList.innerHTML = stock.signals.map(s => `<li>● ${s}</li>`).join('');

    const discountColor = stock.discount >= 0 ? 'text-green-500' : 'text-red-500';
    stockValuationDiv.innerHTML = `
        <div class="flex justify-between font-medium"><span>Mức giá mục tiêu:</span> <span class="text-indigo-500 font-bold">${stock.targetPrice.toLocaleString()} VND</span></div>
        <div class="flex justify-between text-gray-500"><span>Giá trị hiện tại:</span> <span>${stock.currentPrice.toLocaleString()} VND</span></div>
        <div class="flex justify-between text-gray-500"><span>Chiết khấu:</span> <span class="${discountColor}">${stock.discount.toFixed(1)}%</span></div>
    `;
}

searchAnalysisBtn.addEventListener('click', () => {
    const ticker = analysisInput.value.trim().toUpperCase();
    const stock = mockStocks.find(s => s.ticker === ticker);
    renderAnalysisReport(stock);
});
analysisInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        searchAnalysisBtn.click();
    }
});

// New function to handle navigation from Screener to Analysis tab
function viewAnalysis(ticker) {
  window.showTab('analysis');
  analysisInput.value = ticker;
  searchAnalysisBtn.click();
}
</script>
</body>
</html>
